import{Q as x}from"./QBadge-43d1038a.js";import{C as v,p as w,a as k,b as R,B,c as E,L,P as S,d as M,u as N,e as P,f as V}from"./useChartTimeWatcher-d24f242a.js";import{k as Y,F as O,r as l,aR as Q,l as q,D as d,aO as F,bn as G,m as K,G as U,t as p,K as W,v as u,x as m,p as h,w as j,O as z}from"./index-ff52cf3d.js";import{u as A}from"./ui-a8e57791.js";const H={key:0},J={class:"text-h6"},X={class:"text-caption"},te=Y({__name:"ChartPercent",props:{id:{},parentTable:{}},setup(f){const n=f;v.register(w,k,R,B,E,L,S,M);const g=A(),{getPaletteColor:r}=V,{log:C}=O();N(i);const s=l(0),b=Q.PERCENT,_={reactive:!0,responsive:!0,aspectRatio:1,radius:2,plugins:{legend:{display:!1},tooltip:{callbacks:{title:e=>{var a;return((a=e==null?void 0:e[0])==null?void 0:a.label)??""}}}},interaction:{intersect:!1},scales:{x:{ticks:{autoSkip:!0,maxRotation:70,minRotation:70}}}},c=l({labels:[],datasets:[]});q(async()=>{await i()});function y(e,a){return e.p0.parsed.y>e.p1.parsed.y?a:void 0}async function i(){try{const e=d.getChildTable(n.parentTable),a=await d.getSortedChildren(e,n.id);if(a.length>0){const o=a.filter(t=>new Date().getTime()-t.createdTimestamp<=F[g.chartTime]);s.value=o.length;const T=o.map(t=>G.formatDate(t.createdTimestamp,"YYYY MMM D")),D=o.map(t=>t.percent);c.value={labels:T,datasets:[{label:"",backgroundColor:r("white"),borderColor:r("white"),segment:{borderColor:t=>y(t,r("info"))||r("primary")},data:D}]}}}catch(e){C.error("Error loading percent chart",e)}}return(e,a)=>s.value>0?(K(),U("section",H,[p("p",J,[W(u(m(b))+" ",1),h(x,{rounded:"",color:"secondary",class:"q-py-none"},{default:j(()=>[p("span",X,u(s.value)+" records in time frame",1)]),_:1})]),h(m(P),{options:_,data:c.value,style:{"max-height":"500px"}},null,8,["data"])])):z("",!0)}});export{te as default};
