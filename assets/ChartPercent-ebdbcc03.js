import{Q as k}from"./QBadge-6513a4e9.js";import{k as L,F as R,r as o,aR as p,l as w,D as c,aO as S,bn as M,m as i,G as h,t as f,v as g,x as l,p as _,w as N,n as P,O as I}from"./index-ffd0294f.js";import{C as V,p as Y,a as O,b as Q,B as q,c as F,L as G,P as U,d as W,u as $,e as j,f as z}from"./useCharting-a986e035.js";import{_ as A}from"./ErrorStates.vue_vue_type_script_setup_true_lang-ff855ea3.js";import{u as H}from"./ui-c377fbe5.js";const J={key:0},K={key:0},X={class:"text-h6"},Z={class:"text-caption"},oe=L({__name:"ChartPercent",props:{id:{},parentTable:{}},setup(C){const a=C;V.register(Y,O,Q,q,F,G,U,W);const{log:y}=R(),{getChartOptions:D,getChartData:T,getChartDataset:b}=z(),v=H(),m=o(!1),r=o(0),E=p.PERCENT,d=o({labels:[],datasets:[]});w(async()=>{await u()}),$(u);async function u(){try{const{measurementInput:e}=await c.getRecord(a.parentTable,a.id);if(!e)return;e===p.PERCENT&&(m.value=!0);const s=await c.getSortedChildren(c.getChildTable(a.parentTable),a.id);if(s.length===0)return;const n=s.filter(t=>new Date().getTime()-t.createdTimestamp<=S[v.chartTime]);r.value=n.length;const x=n.map(t=>M.formatDate(t.createdTimestamp,"YYYY MMM D")),B=n.map(t=>t.percent);d.value=T(x,b(B,"primary","info"))}catch(e){y.error("Error loading measurement percent chart",e)}}return(e,s)=>m.value?(i(),h("section",J,[r.value>0?(i(),h("div",K,[f("div",X,g(l(E)),1),_(k,{rounded:"",color:"secondary",class:"q-py-none"},{default:N(()=>[f("span",Z,g(r.value)+" records in time frame",1)]),_:1}),_(l(j),{options:l(D)(),data:d.value,style:{"max-height":"500px"}},null,8,["options","data"])])):(i(),P(A,{key:1,error:"no-data"}))])):I("",!0)}});export{oe as default};
