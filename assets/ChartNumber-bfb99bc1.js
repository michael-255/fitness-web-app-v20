import{Q as v}from"./QBadge-43d1038a.js";import{C as w,p as M,a as k,b as B,B as R,c as Y,L,P as S,d as E,u as N,e as V,f as O}from"./useChartTimeWatcher-d24f242a.js";import{k as P,F as Q,r as l,aR as U,l as q,D as d,aO as F,bn as u,m as G,G as K,t as m,K as W,v as p,x as h,p as f,w as j,O as z}from"./index-ff52cf3d.js";import{u as A}from"./ui-a8e57791.js";const H={key:0},J={class:"text-h6"},X={class:"text-caption"},te=P({__name:"ChartNumber",props:{id:{},parentTable:{}},setup(g){const n=g;w.register(M,k,B,R,Y,L,S,E);const b=A(),{getPaletteColor:r}=O,{log:C}=Q();N(i);const s=l(0),_=U.NUMBER,y={reactive:!0,responsive:!0,aspectRatio:1,radius:2,plugins:{legend:{display:!1},tooltip:{callbacks:{title:e=>{var a;return u.formatDate((a=e==null?void 0:e[0])==null?void 0:a.label,"ddd, YYYY MMM D, h:mm a")}}}},interaction:{intersect:!1},scales:{x:{ticks:{autoSkip:!0,maxRotation:70,minRotation:70}}}},c=l({labels:[],datasets:[]});q(async()=>{await i()});function D(e,a){return e.p0.parsed.y>e.p1.parsed.y?a:void 0}async function i(){try{const e=d.getChildTable(n.parentTable),a=await d.getSortedChildren(e,n.id);if(a.length>0){const o=a.filter(t=>new Date().getTime()-t.createdTimestamp<=F[b.chartTime]);s.value=o.length;const T=o.map(t=>u.formatDate(t.createdTimestamp,"YYYY MMM D")),x=o.map(t=>t.number);c.value={labels:T,datasets:[{label:"",backgroundColor:r("white"),borderColor:r("white"),segment:{borderColor:t=>D(t,r("info"))||r("primary")},data:x}]}}}catch(e){C.error("Error loading number chart",e)}}return(e,a)=>s.value>0?(G(),K("section",H,[m("p",J,[W(p(h(_))+" ",1),f(v,{rounded:"",color:"secondary",class:"q-py-none"},{default:j(()=>[m("span",X,p(s.value)+" records in time frame",1)]),_:1})]),f(h(V),{options:y,data:c.value,style:{"max-height":"500px"}},null,8,["data"])])):z("",!0)}});export{te as default};
