import{k,m as a,n as m,w as c,p as u,q as b,t as r,v as i,B as R,W as S,A as V,F as B,r as n,D as _,_ as F,G as Q,M as C,L as $,z as q,x,I as p,H as I,J as L,Q as N}from"./index-26174ac4.js";import{Q as D}from"./QForm-5fdd2440.js";import{_ as j}from"./ResponsivePage.vue_vue_type_script_setup_true_lang-296a0cac.js";import{u as M}from"./useDialogs-efd4deb2.js";import{u as z}from"./useRouting-8dc60f03.js";import"./action-c3948de2.js";import"./QSelect-4607d717.js";import"./QItem-9936e606.js";import"./QItemLabel-c08b08fa.js";import"./QMenu-f6a9d5ab.js";import"./selection-0290b496.js";import"./ui-327ae146.js";const G=r("br",null,null,-1),H=k({__name:"ActiveExerciseCard",props:{parentExercise:{},exerciseResult:{}},setup(E){return(t,d)=>(a(),m(R,null,{default:c(()=>[u(b,null,{default:c(()=>[r("div",null,i(t.parentExercise.name),1),r("div",null,i(t.parentExercise.desc),1),G,r("p",null,i(t.parentExercise),1),r("p",null,i(t.exerciseResult),1)]),_:1})]),_:1}))}}),J={class:"row justify-center q-my-sm"},P={class:"row justify-center"},T=r("span",{class:"text-caption q-ml-xs text-warning"}," Correct invalid entries and try again ",-1),ie=k({__name:"ActiveView",setup(E){S({title:`${V} - Active Workout`});const{log:t}=B(),{confirmDialog:d}=M(),{goToDashboard:g}=z(),l=n(!0),w=n({}),v=n([]),h=n({}),f=n([]),y=_.liveActiveWorkout().subscribe({next:e=>{w.value=e.parentWorkout,v.value=e.parentExercises,h.value=e.workoutResult,f.value=e.exerciseResults,t.info("Live Active Workout",{...e})},error:e=>t.error("Error fetching live Active Workout",e)});F(()=>{y.unsubscribe()});async function A(){d("Finish Workout","Are you ready to finish and save this workout?",p.SAVE,"positive",async()=>{try{await _.finishWorkout(),g()}catch(e){t.error("Failed to save active workout",e)}})}function W(e){return v.value.find(s=>s.id===e)||{}}return(e,s)=>(a(),m(j,null,{default:c(()=>[u(D,{onSubmit:A,onValidationError:s[0]||(s[0]=o=>l.value=!1),onValidationSuccess:s[1]||(s[1]=o=>l.value=!0)},{default:c(()=>[(a(!0),Q($,null,C(f.value,o=>(a(),m(H,{key:o.id,parentExercise:W(o.parentId),exerciseResult:o,class:"q-mb-md"},null,8,["parentExercise","exerciseResult"]))),128)),r("div",J,[u(q,{label:"Finish Workout",type:"submit",color:"positive",icon:x(p).SAVE},null,8,["icon"])]),I(r("div",P,[u(N,{name:x(p).WARN,color:"warning"},null,8,["name"]),T],512),[[L,!l.value]])]),_:1})]),_:1}))}});export{ie as default};
