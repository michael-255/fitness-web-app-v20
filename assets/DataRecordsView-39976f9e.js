import{Q as E,a as _,b as x,c as F}from"./QTable-4066d58c.js";import{k as M,W as P,A as j,F as H,r as m,D as p,_ as K,m as c,n as f,w as a,p as s,G as S,M as Q,L as V,K as g,x as o,U as y,z as u,I as i,O as W,t as b,v as h,Q as q,a1 as z,N as G,H as J,J as X}from"./index-c12ca66e.js";import{Q as Y}from"./QSelect-8c3f6818.js";import{u as Z}from"./useRouting-bb39faa1.js";import{u as ee}from"./useDialogs-77741d46.js";import"./QList-263df6e4.js";import"./QItem-67daa3d7.js";import"./QItemLabel-2db0bac8.js";import"./QMenu-a78e00e8.js";import"./selection-19be5bb5.js";import"./action-dedaa42e.js";import"./QSpace-9bede36f.js";import"./ErrorStates.vue_vue_type_script_setup_true_lang-278c84f0.js";import"./ui-3f8bd917.js";const oe={class:"row justify-start full-width q-mb-md"},le={class:"col-10 text-h6 text-bold ellipsis"},te={class:"row justify-start full-width"},ae={class:"col-12"},De=M({__name:"DataRecordsView",setup(se){P({title:`${j} - Records Data Table`});const{log:v}=H(),{routeTable:r,goToEdit:I,goToCreate:R,goBack:N}=Z(),{confirmDialog:B,inspectDialog:L,chartsDialog:O}=ee(),C=m(""),d=m([]),T=m(p.getTableColumns(r)),k=m(T.value.filter(l=>!l.required)),D=m(k.value.map(l=>l.name)),w=p.liveDataTable(r).subscribe({next:l=>d.value=l,error:l=>v.error("Error fetching live records data",l)});K(()=>{w==null||w.unsubscribe()});async function $(l,t){B("Delete","Permanently delete this record? Please note that all child records are deleted when you delete a parent record.",i.DELETE,"negative",async()=>{try{await p.deleteRecord(l,t),v.info("Successfully deleted record",{table:l,id:t})}catch(e){v.error("Delete failed",e)}})}async function A(l,t){const e=await p.getRecord(l,t);e?L(e,l):v.error("Failed to find record",{table:l,id:t})}async function U(l,t){O(t,l)}return(l,t)=>(c(),f(F,{rows:d.value,columns:T.value,"visible-columns":D.value,"rows-per-page-options":[0],filter:C.value,"virtual-scroll":"",fullscreen:"","row-key":"id"},{header:a(e=>[s(_,{props:e},{default:a(()=>[(c(!0),S(V,null,Q(e.cols,n=>J((c(),f(E,{key:n.name,props:e},{default:a(()=>[g(h(n.label),1)]),_:2},1032,["props"])),[[X,n.name!=="hiddenId"]])),128)),s(E,{"auto-width":"",class:"text-left"},{default:a(()=>[g("Actions")]),_:1})]),_:2},1032,["props"])]),body:a(e=>[s(_,{props:e},{default:a(()=>[(c(!0),S(V,null,Q(e.cols,n=>(c(),f(x,{key:n.name,props:e},{default:a(()=>[g(h(n.value),1)]),_:2},1032,["props"]))),128)),s(x,{"auto-width":""},{default:a(()=>[[o(y).WORKOUTS,o(y).EXERCISES,o(y).MEASUREMENTS].includes(o(r))?(c(),f(u,{key:0,flat:"",round:"",dense:"",class:"q-ml-xs",color:"accent",icon:o(i).CHARTS,onClick:n=>U(o(r),e.cols[0].value)},null,8,["icon","onClick"])):W("",!0),s(u,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"primary",icon:o(i).INSPECT,onClick:n=>A(o(r),e.cols[0].value)},null,8,["icon","onClick"]),s(u,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"orange-9",icon:o(i).EDIT,onClick:n=>o(I)(o(r),e.cols[0].value)},null,8,["icon","onClick"]),s(u,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"negative",onClick:n=>$(o(r),e.cols[0].value),icon:o(i).DELETE},null,8,["onClick","icon"])]),_:2},1024)]),_:2},1032,["props"])]),top:a(()=>[b("div",oe,[b("div",le,h(o(p).getLabel(o(r),"plural")),1),s(u,{round:"",flat:"",class:"absolute-top-right q-mr-sm q-mt-sm",icon:o(i).CLOSE,onClick:t[0]||(t[0]=e=>o(N)())},null,8,["icon"])]),b("div",te,[b("div",ae,[s(z,{disable:!d.value.length,outlined:"",dense:"",clearable:"",debounce:"300",modelValue:C.value,"onUpdate:modelValue":t[3]||(t[3]=e=>C.value=e),placeholder:"Search"},{before:a(()=>[s(u,{color:"positive",class:"q-px-sm q-mr-xs",icon:o(i).ADD,onClick:t[1]||(t[1]=e=>o(R)(o(r)))},null,8,["icon"]),s(Y,{modelValue:D.value,"onUpdate:modelValue":t[2]||(t[2]=e=>D.value=e),options:k.value,disable:!d.value.length,"bg-color":"primary",standout:"",multiple:"",dense:"","options-dense":"","emit-value":"","map-options":"","option-value":"name","display-value":""},{prepend:a(()=>[s(q,{color:"white",name:o(i).OPTIONS},null,8,["name"])]),_:1},8,["modelValue","options","disable"])]),append:a(()=>[s(q,{name:"search"})]),_:1},8,["disable","modelValue"])])])]),bottom:a(()=>[g(h(o(G)(d.value)),1)]),_:1},8,["rows","columns","visible-columns","filter"]))}});export{De as default};
