import{k as x,U as E,A as R,F as $,D as i,r as h,l as B,Z as D,m as r,n as c,w as v,x as e,G as l,M as I,L as V,p as f,I as a,z as y,H as S,J as F,t as C,Q as L,am as Q,an as T,ao as q}from"./index-8596875a.js";import{Q as N}from"./QForm-32f8207e.js";import{u as j,_ as M}from"./useDialogs-f3ccf2ed.js";import{_ as U}from"./ResponsivePage.vue_vue_type_script_setup_true_lang-81b03c32.js";import{u as z}from"./action-5374d455.js";import{u as G}from"./useRouting-297cfe85.js";import"./QSelect-579acf59.js";import"./QItem-c77875af.js";import"./QItemLabel-4eb89e39.js";import"./QMenu-91bbc20f.js";import"./selection-5a997704.js";import"./ui-e95edf17.js";const H={key:0,class:"row justify-center q-my-sm"},J={key:1,class:"row justify-center q-my-sm"},K={class:"row justify-center"},O=C("span",{class:"text-caption q-ml-xs text-warning"}," Correct invalid entries and try again ",-1),ce=x({__name:"CreateView",setup(P){E({title:`${R} - Create Record`});const{routeTable:o,routeParentId:_,goBack:b}=G(),{log:d}=$(),{confirmDialog:w}=j(),t=z(),m=i.getLabel(o,"singular"),g=i.getFieldComponents(o),u=h(!0);B(async()=>{try{t.record=i.getDefaultActionRecord(o),_&&(t.record.parentId=_)}catch(n){d.error("Error loading create view",n)}}),D(()=>{t.$reset()});async function k(){w("Create",`Create ${m} record?`,a.CREATE,"positive",async()=>{try{t.record.id=Q(),t.record.activated=!1,await i.addRecord(o,T(!0,{},t.record)),d.info("Record created",{table:o,id:t.record.id}),b()}catch(n){d.error("Create failed",n)}})}return(n,s)=>(r(),c(U,{bannerIcon:e(a).CREATE,bannerTitle:`Create ${e(m)}`},{default:v(()=>[e(m)&&e(g).length>0?(r(),c(N,{key:0,onSubmit:k,onValidationError:s[0]||(s[0]=p=>u.value=!1),onValidationSuccess:s[1]||(s[1]=p=>u.value=!0)},{default:v(()=>[(r(!0),l(V,null,I(e(g),(p,A)=>(r(),l("div",{key:A,class:"q-mb-md"},[(r(),c(q(p),{inspecting:!1}))]))),128)),e(t).record.activated?(r(),l("div",J,[f(y,{disable:"",label:"Active",color:"warning",icon:e(a).LOCK},null,8,["icon"])])):(r(),l("div",H,[f(y,{label:"Create",type:"submit",color:"positive",icon:e(a).SAVE},null,8,["icon"])])),S(C("div",K,[f(L,{name:e(a).WARN,color:"warning"},null,8,["name"]),O],512),[[F,!u.value]])]),_:1})):(r(),c(M,{key:1,error:"unknown"}))]),_:1},8,["bannerIcon","bannerTitle"]))}});export{ce as default};
