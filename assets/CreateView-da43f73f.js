import{k as A,W as x,A as E,F as R,D as i,r as $,l as h,_ as B,m as r,n as c,w as v,x as e,G as l,M as D,L as V,p as f,I as a,z as g,H as S,J as F,t as y,Q as I,an as L,ao as Q,ap as T}from"./index-26174ac4.js";import{Q as q}from"./QForm-5fdd2440.js";import{u as N,_ as j}from"./useDialogs-efd4deb2.js";import{_ as M}from"./ResponsivePage.vue_vue_type_script_setup_true_lang-296a0cac.js";import{u as W}from"./action-c3948de2.js";import{u as z}from"./useRouting-8dc60f03.js";import"./QSelect-4607d717.js";import"./QItem-9936e606.js";import"./QItemLabel-c08b08fa.js";import"./QMenu-f6a9d5ab.js";import"./selection-0290b496.js";import"./ui-327ae146.js";const G={key:0,class:"row justify-center q-my-sm"},H={key:1,class:"row justify-center q-my-sm"},J={class:"row justify-center"},K=y("span",{class:"text-caption q-ml-xs text-warning"}," Correct invalid entries and try again ",-1),ie=A({__name:"CreateView",setup(O){x({title:`${E} - Create Record`});const{routeTable:o,goBack:C}=z(),{log:d}=R(),{confirmDialog:b}=N(),t=W(),m=i.getLabel(o,"singular"),_=i.getFieldComponents(o),u=$(!0);h(async()=>{try{t.table=o,t.record=i.getDefaultActionRecord(o)}catch(n){d.error("Error loading create view",n)}}),B(()=>{t.$reset()});async function w(){b("Create",`Create ${m} record?`,a.CREATE,"positive",async()=>{try{t.record.id=L(),t.record.activated=!1,await i.addRecord(o,Q(!0,{},t.record)),d.info("Record created",{table:o,id:t.record.id}),C()}catch(n){d.error("Create failed",n)}})}return(n,s)=>(r(),c(M,{bannerIcon:e(a).CREATE,bannerTitle:`Create ${e(m)}`},{default:v(()=>[e(m)&&e(_).length>0?(r(),c(q,{key:0,onSubmit:w,onValidationError:s[0]||(s[0]=p=>u.value=!1),onValidationSuccess:s[1]||(s[1]=p=>u.value=!0)},{default:v(()=>[(r(!0),l(V,null,D(e(_),(p,k)=>(r(),l("div",{key:k,class:"q-mb-md"},[(r(),c(T(p)))]))),128)),e(t).record.activated?(r(),l("div",H,[f(g,{disable:"",label:"Active",color:"warning",icon:e(a).LOCK},null,8,["icon"])])):(r(),l("div",G,[f(g,{label:"Create",type:"submit",color:"positive",icon:e(a).SAVE},null,8,["icon"])])),S(y("div",J,[f(I,{name:e(a).WARN,color:"warning"},null,8,["name"]),K],512),[[F,!u.value]])]),_:1})):(r(),c(j,{key:1,error:"unknown"}))]),_:1},8,["bannerIcon","bannerTitle"]))}});export{ie as default};
