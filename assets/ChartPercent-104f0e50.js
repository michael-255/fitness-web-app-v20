import{Q as B}from"./QBadge-9408e27a.js";import{k as S,F as k,r as o,aR as p,l as L,D as i,aO as R,bn as w,m as c,G as h,t as f,v as g,x as l,p as _,w as M,n as N,O as P}from"./index-c6b448c4.js";import{C as I,p as V,a as Y,b as O,B as Q,c as q,L as F,P as G,d as U,u as W,e as $,f as j}from"./useCharting-6745c2b8.js";import{_ as z}from"./ErrorStates.vue_vue_type_script_setup_true_lang-a42fa437.js";import{u as A}from"./ui-87c8c5bc.js";const H={key:0},J={key:0},K={class:"text-h6"},X={class:"text-caption"},ne=S({__name:"ChartPercent",props:{id:{},parentTable:{}},setup(C){const a=C;I.register(V,Y,O,Q,q,F,G,U);const{log:y}=k(),{getSingleChartOptions:b,getSingleChartDataset:D}=j(),T=A(),m=o(!1),r=o(0),v=p.PERCENT,d=o({labels:[],datasets:[]});L(async()=>{await u()}),W(u);async function u(){try{const{measurementInput:e}=await i.getRecord(a.parentTable,a.id);if(!e||e!==p.PERCENT)return;const s=await i.getSortedChildren(i.getChildTable(a.parentTable),a.id);if(s.length===0)return;const n=s.filter(t=>new Date().getTime()-t.createdTimestamp<=R[T.chartTime]);r.value=n.length;const E=n.map(t=>w.formatDate(t.createdTimestamp,"YYYY MMM D")),x=n.map(t=>t.percent);d.value={labels:E,datasets:[D(x,"primary","primary")]},m.value=!0}catch(e){y.error("Error loading measurement percent chart",e)}}return(e,s)=>m.value?(c(),h("section",H,[r.value>0?(c(),h("div",J,[f("div",K,g(l(v)),1),_(B,{rounded:"",color:"secondary",class:"q-py-none"},{default:M(()=>[f("span",X,g(r.value)+" records in time frame",1)]),_:1}),_(l($),{options:l(b)(),data:d.value,style:{"max-height":"500px"}},null,8,["options","data"])])):(c(),N(z,{key:1,error:"no-data"}))])):P("",!0)}});export{ne as default};
